<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Tracker</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="page">
        <div class="login-container">
            <div class="login-header">
                <h1>Finance Tracker</h1>
                <p>Manage your household finances wisely</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Enter username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
                <p class="register-link">Don't have an account? <a href="#" id="showRegister">Register here</a></p>
            </form>

            <!-- REGISTER FORM -->
            <form id="registerForm" class="login-form" style="display:none;">
                <div class="form-group">
                    <label for="regUsername">Username</label>
                    <input type="text" id="regUsername" placeholder="Create username" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" placeholder="Create password" required>
                </div>
                <div class="form-group">
                    <label for="regConfirm">Confirm Password</label>
                    <input type="password" id="regConfirm" placeholder="Repeat password" required>
                </div>
                <div class="form-group">
                    <label for="regGaji">Monthly Salary (Rp)</label>
                    <input type="number" id="regGaji" placeholder="6000000" value="6000000" required>
                </div>
                <button type="submit" class="btn btn-primary">Register</button>
                <p class="register-link"><a href="#" id="showLogin">Already have an account? Login</a></p>
            </form>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="mainApp" class="page" style="display:none;">
        <!-- SIDEBAR -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>Finance Tracker</h2>
                <p id="welcomeUser">Hello, User!</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-page="dashboard">
                    <span class="icon">üìä</span> Dashboard
                </li>
                <li class="nav-item" data-page="transaksi">
                    <span class="icon">üí∞</span> Transaction
                </li>
                <li class="nav-item" data-page="tabungan">
                    <span class="icon">üè¶</span> Savings
                </li>
                <li class="nav-item" data-page="budget">
                    <span class="icon">üìã</span> Budget
                </li>
                <li class="nav-item" data-page="laporan">
                    <span class="icon">üìà</span> Report
                </li>
                <li class="nav-item" data-page="pengaturan">
                    <span class="icon">‚öôÔ∏è</span> Settings
                </li>
            </ul>
            <button class="btn btn-logout" id="logoutBtn">Logout</button>
        </nav>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- DASHBOARD -->
            <section id="dashboardSection" class="content-section">
                <!-- Dashboard Header -->
                <div class="dashboard-header">
                    <div class="dashboard-title">
                        <h2>Dashboard</h2>
                        <p class="dashboard-subtitle">Monitor your financial health</p>
                    </div>
                    <div class="period-selector">
                        <select id="dashboardMonthSelect" onchange="updateDashboardMonth()">
                            <option value="01">January</option>
                            <option value="02">February</option>
                            <option value="03">March</option>
                            <option value="04">April</option>
                            <option value="05">May</option>
                            <option value="06">June</option>
                            <option value="07">July</option>
                            <option value="08">August</option>
                            <option value="09">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <select id="dashboardYear" onchange="updateDashboardMonth()">
                        </select>
                        <input type="hidden" id="dashboardMonth">
                    </div>
                </div>

                <!-- Financial Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card income-card">
                        <div class="summary-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                        <div class="summary-content">
                            <span class="summary-label">Total Income</span>
                            <span class="summary-value" id="totalIncome">Rp 0</span>
                            <span class="summary-period">This month</span>
                        </div>
                    </div>
                    <div class="summary-card expense-card">
                        <div class="summary-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 3h18v18H3zM21 9H3M9 21V9"/>
                            </svg>
                        </div>
                        <div class="summary-content">
                            <span class="summary-label">Total Expense</span>
                            <span class="summary-value" id="totalExpense">Rp 0</span>
                            <span class="summary-period">This month</span>
                        </div>
                    </div>
                    <div class="summary-card balance-card">
                        <div class="summary-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                <path d="M9 12l2 2 4-4"/>
                            </svg>
                        </div>
                        <div class="summary-content">
                            <span class="summary-label">Balance</span>
                            <span class="summary-value" id="totalBalance">Rp 0</span>
                            <span class="summary-period">This month</span>
                        </div>
                    </div>
                </div>

                <!-- Budget Status Section -->
                <div class="budget-section">
                    <div class="section-header">
                        <h3>Budget Status</h3>
                        <span class="section-badge">4 Categories</span>
                    </div>
                    <div class="budget-grid">
                        <!-- Living -->
                        <div class="budget-item living">
                            <div class="budget-item-header">
                                <div class="budget-item-icon">üè†</div>
                                <div class="budget-item-info">
                                    <h4>Living</h4>
                                </div>
                            </div>
                            <div class="budget-item-progress">
                                <div class="progress-track">
                                    <div class="progress-fill" id="livingProgress"></div>
                                </div>
                            </div>
                            <div class="budget-item-stats">
                                <div class="stat">
                                    <span class="stat-label">Budget</span>
                                    <span class="stat-value" id="livingBudget">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Used</span>
                                    <span class="stat-value expense" id="livingUsed">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Left</span>
                                    <span class="stat-value success" id="livingRemain">Rp 0</span>
                                </div>
                            </div>
                        </div>
                        <!-- Saving -->
                        <div class="budget-item saving">
                            <div class="budget-item-header">
                                <div class="budget-item-icon">üíé</div>
                                <div class="budget-item-info">
                                    <h4>Saving</h4>
                                </div>
                            </div>
                            <div class="budget-item-progress">
                                <div class="progress-track">
                                    <div class="progress-fill saving" id="savingProgress"></div>
                                </div>
                            </div>
                            <div class="budget-item-stats">
                                <div class="stat">
                                    <span class="stat-label">Target</span>
                                    <span class="stat-value" id="savingBudget">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Saved</span>
                                    <span class="stat-value success" id="savingUsed">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Left</span>
                                    <span class="stat-value" id="savingRemain">Rp 0</span>
                                </div>
                            </div>
                        </div>
                        <!-- Playing -->
                        <div class="budget-item playing">
                            <div class="budget-item-header">
                                <div class="budget-item-icon">‚úàÔ∏è</div>
                                <div class="budget-item-info">
                                    <h4>Playing</h4>
                                </div>
                            </div>
                            <div class="budget-item-progress">
                                <div class="progress-track">
                                    <div class="progress-fill playing" id="playingProgress"></div>
                                </div>
                            </div>
                            <div class="budget-item-stats">
                                <div class="stat">
                                    <span class="stat-label">Budget</span>
                                    <span class="stat-value" id="playingBudget">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Used</span>
                                    <span class="stat-value expense" id="playingUsed">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Left</span>
                                    <span class="stat-value success" id="playingRemain">Rp 0</span>
                                </div>
                            </div>
                        </div>
                        <!-- Emergency -->
                        <div class="budget-item emergency">
                            <div class="budget-item-header">
                                <div class="budget-item-icon">üö®</div>
                                <div class="budget-item-info">
                                    <h4>Emergency</h4>
                                </div>
                            </div>
                            <div class="budget-item-progress">
                                <div class="progress-track">
                                    <div class="progress-fill emergency" id="emergencyProgress"></div>
                                </div>
                            </div>
                            <div class="budget-item-stats">
                                <div class="stat">
                                    <span class="stat-label">Budget</span>
                                    <span class="stat-value" id="emergencyBudget">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Used</span>
                                    <span class="stat-value expense" id="emergencyUsed">Rp 0</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Left</span>
                                    <span class="stat-value success" id="emergencyRemain">Rp 0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Expense Distribution</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="expenseChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Monthly Trend</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="recent-section">
                    <div class="section-header">
                        <h3>Recent Transactions</h3>
                        <a href="#" onclick="switchPage('transaksi'); return false;" class="view-all-link">View All</a>
                    </div>
                    <div class="recent-list" id="recentList"></div>
                </div>
            </section>

            <!-- TRANSAKSI -->
            <section id="transaksiSection" class="content-section" style="display:none;">
                <h2>Manage Transactions</h2>

                <div class="transaction-form-container">
                    <form id="transactionForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Type</label>
                                <select id="txType" required onchange="updateCategoryOptions()">
                                    <option value="expense">Expense</option>
                                    <option value="income">Income</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="txCategory" required>
                                    <option value="living">Living</option>
                                    <option value="saving">Saving</option>
                                    <option value="playing">Playing</option>
                                    <option value="emergency">Emergency</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Amount (Rp)</label>
                                <input type="number" id="txAmount" placeholder="100000" required>
                            </div>
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" id="txDate" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" id="txDescription" placeholder="Example: Monthly shopping">
                        </div>
                        <button type="submit" class="btn btn-primary">Add Transaction</button>
                    </form>
                </div>

                <div class="transaction-filters">
                    <select id="filterYear" onchange="updateFilterMonth()">
                    </select>
                    <select id="filterMonthSelect" onchange="updateFilterMonth()">
                        <option value="01">Jan</option>
                        <option value="02">Feb</option>
                        <option value="03">Mar</option>
                        <option value="04">Apr</option>
                        <option value="05">May</option>
                        <option value="06">Jun</option>
                        <option value="07">Jul</option>
                        <option value="08">Aug</option>
                        <option value="09">Sep</option>
                        <option value="10">Oct</option>
                        <option value="11">Nov</option>
                        <option value="12">Dec</option>
                    </select>
                    <input type="hidden" id="filterMonth">
                    <select id="filterType">
                        <option value="all">All Types</option>
                        <option value="income">Income</option>
                        <option value="expense">Expense</option>
                    </select>
                    <select id="filterCategory">
                        <option value="all">All Categories</option>
                        <option value="living">Living</option>
                        <option value="saving">Saving</option>
                        <option value="playing">Playing</option>
                        <option value="emergency">Emergency</option>
                    </select>
                </div>

                <div class="transaction-table-container">
                    <table class="transaction-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactionList"></tbody>
                    </table>
                </div>
            </section>

            <!-- TABUNGAN -->
            <section id="tabunganSection" class="content-section" style="display:none;">
                <h2>My Savings</h2>
                <p class="section-desc">Track your savings progress over time</p>

                <div class="savings-overview">
                    <div class="savings-main-card">
                        <div class="savings-icon">üí∞</div>
                        <div class="savings-info">
                            <h3>Total Accumulated Savings</h3>
                            <p id="accumulatedSavings">Rp 0</p>
                            <small>Accumulated balance from all months</small>
                        </div>
                    </div>
                </div>

                <div class="savings-charts">
                    <div class="chart-box">
                        <h3>Savings Growth Chart</h3>
                        <canvas id="savingsLineChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3>Monthly Balance</h3>
                        <canvas id="savingsBarChart"></canvas>
                    </div>
                </div>

                <div class="savings-history-section">
                    <h3>Monthly Balance History</h3>
                    <div class="savings-history-table">
                        <div class="history-header">
                            <span>Month</span>
                            <span>Income</span>
                            <span>Expense</span>
                            <span>Balance</span>
                        </div>
                        <div id="savingsHistoryList"></div>
                    </div>
                </div>
            </section>

            <!-- BUDGET -->
            <section id="budgetSection" class="content-section" style="display:none;">
                <h2>Budget Allocation</h2>
                <p class="section-desc">Set your monthly salary budget percentages</p>

                <div class="budget-settings">
                    <div class="gaji-setting">
                        <label>Monthly Salary</label>
                        <input type="number" id="gajiInput" placeholder="6000000">
                        <button class="btn btn-secondary" id="updateGaji">Update Salary</button>
                    </div>

                    <div class="percentage-settings">
                        <div class="percentage-item">
                            <label>üè† Living (Essentials)</label>
                            <div class="percentage-input">
                                <input type="range" id="livingPercent" min="0" max="100" value="50" disabled>
                                <span id="livingPercentValue">50%</span>
                            </div>
                            <div class="amount-input">
                                <span>Rp</span>
                                <input type="number" id="livingAmountInput" class="amount-number" placeholder="0">
                            </div>
                        </div>
                        <div class="percentage-item">
                            <label>üíé Saving</label>
                            <div class="percentage-input">
                                <input type="range" id="savingPercent" min="0" max="100" value="30" disabled>
                                <span id="savingPercentValue">30%</span>
                            </div>
                            <div class="amount-input">
                                <span>Rp</span>
                                <input type="number" id="savingAmountInput" class="amount-number" placeholder="0">
                            </div>
                        </div>
                        <div class="percentage-item">
                            <label>‚úàÔ∏è Playing (Lifestyle & Travel)</label>
                            <div class="percentage-input">
                                <input type="range" id="playingPercent" min="0" max="100" value="10" disabled>
                                <span id="playingPercentValue">10%</span>
                            </div>
                            <div class="amount-input">
                                <span>Rp</span>
                                <input type="number" id="playingAmountInput" class="amount-number" placeholder="0">
                            </div>
                        </div>
                        <div class="percentage-item emergency-item">
                            <label>üö® Emergency Fund</label>
                            <div class="percentage-input">
                                <input type="range" id="emergencyPercent" min="0" max="100" value="10" disabled>
                                <span id="emergencyPercentValue">10%</span>
                            </div>
                            <div class="amount-input">
                                <span>Rp</span>
                                <input type="number" id="emergencyAmountInput" class="amount-number" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <div class="total-percentage">
                        <span>Total: <strong id="totalPercent">100%</strong></span>
                        <span id="percentWarning" class="warning" style="display:none;">Total must be 100%!</span>
                    </div>

                    <button class="btn btn-primary" id="saveBudget">Save Budget Settings</button>
                </div>
            </section>

            <!-- LAPORAN -->
            <section id="laporanSection" class="content-section" style="display:none;">
                <h2>Financial Report</h2>

                <div class="report-filters">
                    <div class="form-group">
                        <label>Year</label>
                        <select id="reportYear" onchange="updateReportMonth()">
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Month</label>
                        <select id="reportMonthSelect" onchange="updateReportMonth()">
                            <option value="01">January</option>
                            <option value="02">February</option>
                            <option value="03">March</option>
                            <option value="04">April</option>
                            <option value="05">May</option>
                            <option value="06">June</option>
                            <option value="07">July</option>
                            <option value="08">August</option>
                            <option value="09">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <input type="hidden" id="reportMonth">
                    </div>
                    <button class="btn btn-secondary" id="generateReport">Show Report</button>
                </div>

                <div class="report-summary">
                    <div class="report-card">
                        <h4>Period Summary</h4>
                        <div class="report-stats">
                            <div class="report-stat">
                                <span>Total Income</span>
                                <strong id="reportIncome">Rp 0</strong>
                            </div>
                            <div class="report-stat">
                                <span>Total Expense</span>
                                <strong id="reportExpense">Rp 0</strong>
                            </div>
                            <div class="report-stat">
                                <span>Difference</span>
                                <strong id="reportDiff">Rp 0</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="report-details">
                    <div class="report-chart">
                        <h4>Expense by Category Chart</h4>
                        <canvas id="reportPieChart"></canvas>
                    </div>
                    <div class="report-breakdown">
                        <h4>Category Breakdown</h4>
                        <div id="categoryBreakdown"></div>
                    </div>
                </div>

                <div class="export-section">
                    <button class="btn btn-secondary" id="exportCSV">Export CSV</button>
                </div>

                <!-- ANALISIS & SARAN -->
                <div class="analysis-section">
                    <h3>Financial Analysis & Suggestions</h3>

                    <div class="analysis-cards">
                        <!-- Skor Kesehatan Keuangan -->
                        <div class="analysis-card health-score">
                            <h4>Financial Health Score</h4>
                            <div class="score-circle">
                                <span id="healthScore">0</span>
                                <small>/100</small>
                            </div>
                            <p id="healthStatus" class="health-status">-</p>
                        </div>

                        <!-- Ringkasan Analisis -->
                        <div class="analysis-card summary">
                            <h4>Summary</h4>
                            <div class="analysis-stats">
                                <div class="analysis-stat">
                                    <span>Saving Ratio</span>
                                    <strong id="savingRatio">0%</strong>
                                </div>
                                <div class="analysis-stat">
                                    <span>Expense Ratio</span>
                                    <strong id="expenseRatio">0%</strong>
                                </div>
                                <div class="analysis-stat">
                                    <span>Budget Remaining</span>
                                    <strong id="budgetRemaining">Rp 0</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Detail Analisis per Kategori -->
                    <div class="category-analysis">
                        <h4>Category Analysis</h4>
                        <div id="categoryAnalysis"></div>
                    </div>

                    <!-- Saran Keuangan -->
                    <div class="suggestions-section">
                        <h4>Suggestions & Recommendations</h4>
                        <div id="financialSuggestions"></div>
                    </div>

                    <!-- Tips Keuangan -->
                    <div class="tips-section">
                        <h4>Financial Tips</h4>
                        <div id="financialTips"></div>
                    </div>
                </div>
            </section>

            <!-- PENGATURAN -->
            <section id="pengaturanSection" class="content-section" style="display:none;">
                <h2>Account Settings</h2>

                <div class="settings-container">
                    <div class="setting-card">
                        <h3>Change Password</h3>
                        <form id="changePasswordForm">
                            <div class="form-group">
                                <label>Old Password</label>
                                <input type="password" id="oldPassword" required>
                            </div>
                            <div class="form-group">
                                <label>New Password</label>
                                <input type="password" id="newPassword" required>
                            </div>
                            <div class="form-group">
                                <label>Confirm New Password</label>
                                <input type="password" id="confirmNewPassword" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Change Password</button>
                        </form>
                    </div>

                    <div class="setting-card danger">
                        <h3>Data & Backup</h3>
                        <p>Export all your financial data</p>
                        <button class="btn btn-secondary" id="exportData">Export Data (JSON)</button>
                        <hr>
                        <p>Import data from backup</p>
                        <input type="file" id="importFile" accept=".json">
                        <button class="btn btn-secondary" id="importData">Import Data</button>
                        <hr>
                        <p class="warning-text">Delete all data (cannot be undone!)</p>
                        <button class="btn btn-danger" id="clearData">Delete All Data</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL EDIT TRANSACTION -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeEditModal()">&times;</span>
            <h3>Edit Transaction</h3>
            <form id="editTransactionForm">
                <input type="hidden" id="editTxId">
                <div class="form-group">
                    <label>Type</label>
                    <select id="editTxType" required onchange="updateEditCategoryOptions()">
                        <option value="expense">Expense</option>
                        <option value="income">Income</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="editTxCategory" required></select>
                </div>
                <div class="form-group">
                    <label>Amount (Rp)</label>
                    <input type="number" id="editTxAmount" required>
                </div>
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="editTxDate" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="editTxDescription">
                </div>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- LOADING OVERLAY -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>
